#!/bin/sh

# Run lint-staged for frontend files (Biome)
cd app
npx lint-staged
cd ..

# Run Ruff for Python backend files
if command -v ruff >/dev/null 2>&1; then
  # Get staged Python files in api directory
  STAGED_PY_FILES=$(git diff --cached --name-only --diff-filter=ACM -- '*.py' | grep '^api/')
  if [ -n "$STAGED_PY_FILES" ]; then
    echo "Running Ruff on staged Python files..."
    echo "$STAGED_PY_FILES" | xargs ruff check --fix
    # Re-add fixed files to staging
    echo "$STAGED_PY_FILES" | xargs git add
  fi
fi
